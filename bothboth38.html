
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Number Facts Generator</title>

<style>
  body{
    font-family: Arial, sans-serif;
    margin: 0;
    color:#111;
    background:#fff;
  }

  .page{
    padding: 26px 30px 40px 30px;
  }

  h1{
    text-align:center;
    margin: 6px 0 4px 0;
    font-size: 34px;
    font-weight: 700;
  }

  .subtitle{
    text-align:center;
    font-size: 14px;
    max-width: 980px;
    margin: 0 auto 18px auto;
  }

  .section{
    border: 1px solid #999;
    padding: 14px 12px 16px 12px;
    margin: 0 auto 18px auto;
    max-width: 1220px;
  }

  .sectionTitle{
    text-align:center;
    font-weight: 700;
    margin: 2px 0 14px 0;
  }

  .selectLayout{
    display:grid;
    grid-template-columns: auto 300px;
    gap: 22px;
    align-items:start;
    justify-content:center;
  }

  .twoGrids{
    display:flex;
    justify-content:center;
    gap: 26px;
    flex-wrap:wrap;
  }

  .gridPanel{
    min-width: 520px;
  }

  .panelTitle{
    text-align:center;
    font-weight:700;
    margin: 0 0 10px 0;
  }

  .gridWrap{
    display:flex;
    justify-content:center;
    overflow-x:auto;
    padding: 0 4px;
  }

  table{
    border-collapse: separate;
    border-spacing: 10px 8px;
  }

  th, td{
    text-align:center;
    vertical-align: middle;
    padding: 0;
  }

  .corner{
    width: 46px;
    height: 28px;
  }

  .colHeader,
  .rowHeader{
    background:#111;
    color:#fff;
    border-radius:4px;
    font-weight:700;
    font-size:12px;
    line-height:28px;
    user-select:none;
  }

  .colHeader{ width:68px; height:28px; }
  .rowHeader{ width:46px; height:28px; }

  .cell{
    width:68px;
    height:28px;
    border:1px solid #cfcfcf;
    border-radius:4px;
    font-size:12px;
    line-height:28px;
    cursor:pointer;
    user-select:none;
    background:#fff;
  }

  .cell.selected{
    background:#1f3a8a;
    color:#fff;
    border-color:#1f3a8a;
  }

  .cell.levelSelected{
    outline: 3px solid #111;
    outline-offset: -3px;
  }

  .cell.disabled{
    background:#f2f2f2;
    border-color:#e2e2e2;
    cursor: default;
    color: transparent;
  }

  .levelsBox{
    border:1px solid #cfcfcf;
    padding: 10px 10px 12px 10px;
    border-radius:8px;
    width: 300px;
    box-sizing:border-box;
  }

  .levelsTitle{
    font-weight:700;
    text-align:left;
    margin-bottom:10px;
  }

  .levelsSubtitle{
    font-weight:700;
    margin-top:12px;
    margin-bottom:6px;
    font-size:13px;
  }

  .levelRow{
    display:flex;
    align-items:center;
    gap:10px;
    margin: 8px 0;
    font-size:13px;
  }

  .levelRow input{
    width: 16px;
    height: 16px;
  }

  .buttonRow{
    display:flex;
    justify-content:center;
    gap: 12px;
    margin-top: 14px;
    flex-wrap:wrap;
  }

  .btn{
    padding:6px 14px;
    border:1px solid #777;
    background:#fff;
    cursor:pointer;
    border-radius:8px;
    font-size:13px;
  }

  .designRow{
    display:grid;
    grid-template-columns: 1fr auto 1fr;
    align-items:center;
    gap:12px;
    max-width: 1220px;
    margin: 0 auto;
  }

  .modeRow{
    display:flex;
    justify-content:center;
    gap:10px;
    flex-wrap:wrap;
    margin-top: 8px;
  }

  .modeBtn{
    padding:10px 14px;
    border:1px solid #777;
    background:#fff;
    cursor:pointer;
    border-radius:12px;
    font-size:14px;
    min-width: 220px;
  }

  .modeBtn.active{
    background:#111;
    color:#fff;
  }

  .designBlock{
    text-align:center;
    font-size:13px;
  }

  .choiceRow{
    margin-top:10px;
    display:flex;
    justify-content:center;
    gap:8px;
    flex-wrap:wrap;
  }

  .choice{
    min-width:44px;
    height:32px;
    padding: 0 12px;
    border:1px solid #777;
    background:#fff;
    cursor:pointer;
    font-size:13px;
    border-radius:10px;
  }

  .choice.active{
    background:#111;
    color:#fff;
  }

  .opRow{
    display:flex;
    justify-content:center;
    gap:8px;
    flex-wrap:wrap;
    margin-top: 10px;
  }

  .opBtn{
    min-width: 140px;
    padding:8px 12px;
    border:1px solid #777;
    background:#fff;
    cursor:pointer;
    border-radius:12px;
    font-size:13px;
  }

  .opBtn.active{
    background:#111;
    color:#fff;
  }

  .generateBtn{
    background:#c00;
    color:#fff;
    border:none;
    padding:10px 18px;
    font-size:14px;
    cursor:pointer;
    border-radius:10px;
  }

  .printNote{
    font-size:12px;
    margin-top:8px;
    text-align:center;
    max-width: 820px;
    margin-left:auto;
    margin-right:auto;
  }

  @media (max-width: 1100px){
    .selectLayout{
      grid-template-columns: 1fr;
      justify-items:center;
    }
    .levelsBox{
      width: min(520px, 100%);
    }
  }

  @media print{
    .noPrint{ display:none; }
    .page{ padding:0; }
  }
</style>
</head>

<body>
<div class="page">

<h1>Number Facts Practice Sheet Generator</h1>
<div class="subtitle">
Select addition or subtraction facts to focus on, then design and generate printable practice sheets or flashcards.
</div>

<div class="section">
  <div class="sectionTitle">Select number facts</div>

  <div class="selectLayout">
    <div class="twoGrids">
      <div class="gridPanel">
        <div class="panelTitle">Addition facts</div>
        <div class="gridWrap">
          <table id="addTable"></table>
        </div>
      </div>

      <div class="gridPanel">
        <div class="panelTitle">Subtraction facts</div>
        <div class="gridWrap">
          <table id="subTable"></table>
        </div>
      </div>
    </div>

    <div class="levelsBox noPrint">
      <div class="levelsTitle">Levels</div>

      <div class="levelsSubtitle">Level 1</div>

      <label class="levelRow">
        <input type="checkbox" id="lvl11" onchange="toggleLevel('1.1', this.checked)">
        <span>Level 1.1  No more, no less</span>
      </label>

      <label class="levelRow">
        <input type="checkbox" id="lvl12" onchange="toggleLevel('1.2', this.checked)">
        <span>Level 1.2</span>
      </label>

      <label class="levelRow">
        <input type="checkbox" id="lvl13" onchange="toggleLevel('1.3', this.checked)">
        <span>Level 1.3  All add and subtract zero</span>
      </label>

      <div class="levelsSubtitle">Level 2</div>

      <label class="levelRow">
        <input type="checkbox" id="lvl21" onchange="toggleLevel('2.1', this.checked)">
        <span>Level 2.1  One more, one less within 5</span>
      </label>

      <label class="levelRow">
        <input type="checkbox" id="lvl22" onchange="toggleLevel('2.2', this.checked)">
        <span>Level 2.2  One more, one less 6 to 10</span>
      </label>

      <label class="levelRow">
        <input type="checkbox" id="lvl23" onchange="toggleLevel('2.3', this.checked)">
        <span>Level 2.3  One more, one less within 10</span>
      </label>

      <div class="levelsSubtitle">Level 3</div>

      <label class="levelRow">
        <input type="checkbox" id="lvl31" onchange="toggleLevel('3.1', this.checked)">
        <span>Level 3.1  Doubles to 10</span>
      </label>

      <label class="levelRow">
        <input type="checkbox" id="lvl32" onchange="toggleLevel('3.2', this.checked)">
        <span>Level 3.2  Halving within 10</span>
      </label>

      <label class="levelRow">
        <input type="checkbox" id="lvl33" onchange="toggleLevel('3.3', this.checked)">
        <span>Level 3.3  Doubles within 20</span>
      </label>

      <div style="font-size:12px;margin-top:10px;line-height:1.4;">
        Clicking a level selects and highlights the facts for that level.
      </div>
    </div>
  </div>

  <div class="buttonRow noPrint">
    <button class="btn" type="button" onclick="selectAllAddition()">Select all addition</button>
    <button class="btn" type="button" onclick="clearAddition()">Clear addition</button>
    <button class="btn" type="button" onclick="selectAllSubtraction()">Select all subtraction</button>
    <button class="btn" type="button" onclick="clearSubtraction()">Clear subtraction</button>
    <button class="btn" type="button" onclick="clearAll()">Clear all</button>
  </div>
</div>

<div class="section">
  <div class="sectionTitle">Design</div>

  <div class="modeRow noPrint">
    <button class="modeBtn active" type="button" id="modePractice" onclick="setMode('practice')">Practice sheet</button>
    <button class="modeBtn" type="button" id="modeFlash" onclick="setMode('flashcards')">Flashcards with answer backs</button>
  </div>

  <div class="opRow noPrint">
    <button class="opBtn active" type="button" id="opAdd" onclick="setOp('add')">Addition only</button>
    <button class="opBtn" type="button" id="opSub" onclick="setOp('sub')">Subtraction only</button>
    <button class="opBtn" type="button" id="opBoth" onclick="setOp('both')">Both</button>
  </div>

  <div class="designRow noPrint" style="margin-top:14px;">
    <div></div>

    <div style="text-align:center;">
      <button class="generateBtn" type="button" onclick="generate()">Generate</button>
      <div class="printNote" id="hint"></div>
      <div class="printNote">
        For clean printing, open Print Preview, then More settings, then turn off Headers and footers.
        For double sided flashcards, print double sided and flip on long edge.
      </div>
    </div>

    <div class="designBlock">
      <div>Select number</div>
      <div class="choiceRow" id="pageButtons">
        <button class="choice active" type="button" onclick="setPages(1)">1</button>
        <button class="choice" type="button" onclick="setPages(2)">2</button>
        <button class="choice" type="button" onclick="setPages(3)">3</button>
        <button class="choice" type="button" onclick="setPages(4)">4</button>
        <button class="choice" type="button" onclick="setPages(5)">5</button>
        <button class="choice" type="button" onclick="setPages(10)">10</button>
      </div>
    </div>
  </div>
</div>

</div>

<script>
const MAX_N = 10;

const addTable = document.getElementById("addTable");
const subTable = document.getElementById("subTable");
const hint = document.getElementById("hint");

let manualAdd = new Set();
let manualSub = new Set();

let pageCount = 1;
let mode = "practice";
let opChoice = "add";

const activeLevels = new Set();

const addCells = {};
const subCells = {};

function k(a,b){ return a + "|" + b; }
function parseKey(s){
  const p = s.split("|");
  return { a: parseInt(p[0],10), b: parseInt(p[1],10) };
}

function buildAdditionTable(){
  addTable.innerHTML = "";

  const hr = document.createElement("tr");
  const corner = document.createElement("th");
  corner.className = "corner";
  hr.appendChild(corner);

  for(let c=0;c<=MAX_N;c++){
    const th = document.createElement("th");
    th.className = "colHeader";
    th.textContent = c;
    hr.appendChild(th);
  }
  addTable.appendChild(hr);

  for(let r=0;r<=MAX_N;r++){
    const tr = document.createElement("tr");

    const rh = document.createElement("th");
    rh.className = "rowHeader";
    rh.textContent = r;
    tr.appendChild(rh);

    for(let c=0;c<=MAX_N;c++){
      const td = document.createElement("td");
      td.className = "cell";
      td.textContent = r + " + " + c;

      addCells[k(r,c)] = td;

      td.onclick = () => {
        const key = k(r,c);
        if(manualAdd.has(key)) manualAdd.delete(key);
        else manualAdd.add(key);
        refreshSelections();
      };

      tr.appendChild(td);
    }
    addTable.appendChild(tr);
  }
}

function buildSubtractionTable(){
  subTable.innerHTML = "";

  const hr = document.createElement("tr");
  const corner = document.createElement("th");
  corner.className = "corner";
  hr.appendChild(corner);

  for(let c=0;c<=MAX_N;c++){
    const th = document.createElement("th");
    th.className = "colHeader";
    th.textContent = c;
    hr.appendChild(th);
  }
  subTable.appendChild(hr);

  for(let r=0;r<=MAX_N;r++){
    const tr = document.createElement("tr");

    const rh = document.createElement("th");
    rh.className = "rowHeader";
    rh.textContent = r;
    tr.appendChild(rh);

    for(let c=0;c<=MAX_N;c++){
      const td = document.createElement("td");

      if(r < c){
        td.className = "cell disabled";
        td.textContent = "";
        tr.appendChild(td);
        continue;
      }

      td.className = "cell";
      td.textContent = r + " − " + c;

      subCells[k(r,c)] = td;

      td.onclick = () => {
        const key = k(r,c);
        if(manualSub.has(key)) manualSub.delete(key);
        else manualSub.add(key);
        refreshSelections();
      };

      tr.appendChild(td);
    }
    subTable.appendChild(tr);
  }
}

function setMode(m){
  mode = m;
  document.getElementById("modePractice").classList.toggle("active", m === "practice");
  document.getElementById("modeFlash").classList.toggle("active", m === "flashcards");
  updateHint();
}

function setOp(o){
  opChoice = o;
  document.getElementById("opAdd").classList.toggle("active", o === "add");
  document.getElementById("opSub").classList.toggle("active", o === "sub");
  document.getElementById("opBoth").classList.toggle("active", o === "both");
  updateHint();
}

function setPages(n){
  pageCount = n;
  document.querySelectorAll("#pageButtons .choice").forEach(b=>b.classList.remove("active"));
  Array.from(document.querySelectorAll("#pageButtons .choice")).forEach(btn=>{
    if(parseInt(btn.textContent,10) === n) btn.classList.add("active");
  });
}

function updateHint(){
  if(mode === "practice"){
    hint.textContent = "Practice sheets include 30 questions per sheet arranged in 3 columns of 10.";
  }else{
    hint.textContent = "Flashcards include 10 cards per sheet plus a matching answer back sheet.";
  }
}

function levelFacts(level){
  if(level === "1.1"){
    const add = [];
    const sub = [];
    for(let a=0;a<=5;a++){
      add.push([a,0]);
      add.push([0,a]);
      sub.push([a,0]);
    }
    return { add, sub };
  }

  if(level === "1.2"){
    const add = [];
    const sub = [];
    for(let a=6;a<=10;a++){
      add.push([a,0]);
      add.push([0,a]);
      sub.push([a,0]);
    }
    return { add, sub };
  }

  if(level === "1.3"){
    const add = [];
    const sub = [];
    for(let a=0;a<=10;a++){
      add.push([a,0]);
      add.push([0,a]);
      sub.push([a,0]);
    }
    return { add, sub };
  }

  if(level === "2.1"){
    const add = [];
    const sub = [];
    for(let a=0;a<=5;a++){
      add.push([a,2]);
      add.push([2,a]);
    }
    for(let a=2;a<=5;a++){
      sub.push([a,2]);
    }
    return { add, sub };
  }

  if(level === "2.2"){
    const add = [];
    const sub = [];
    for(let a=6;a<=10;a++){
      add.push([a,2]);
      add.push([2,a]);
      sub.push([a,2]);
    }
    return { add, sub };
  }

  if(level === "2.3"){
    const add = [];
    const sub = [];
    for(let a=0;a<=10;a++){
      add.push([a,2]);
      add.push([2,a]);
    }
    for(let a=2;a<=10;a++){
      sub.push([a,2]);
    }
    return { add, sub };
  }

  if(level === "3.1"){
    const add = [];
    const sub = [];
    for(let a=0;a<=5;a++){
      add.push([a,a]);
    }
    return { add, sub };
  }

  if(level === "3.2"){
    const add = [];
    const sub = [];
    sub.push([0,0]);
    for(let a=2;a<=10;a+=2){
      sub.push([a, a/2]);
    }
    return { add, sub };
  }

  if(level === "3.3"){
    const add = [];
    const sub = [];
    for(let a=0;a<=10;a++){
      add.push([a,a]);
    }
    return { add, sub };
  }

  return { add:[], sub:[] };
}

function getLevelSets(){
  const levelAdd = new Set();
  const levelSub = new Set();

  activeLevels.forEach(level=>{
    const f = levelFacts(level);
    f.add.forEach(([a,b])=>levelAdd.add(k(a,b)));
    f.sub.forEach(([a,b])=>levelSub.add(k(a,b)));
  });

  return { levelAdd, levelSub };
}

function refreshSelections(){
  const { levelAdd, levelSub } = getLevelSets();

  const unionAdd = new Set([...manualAdd, ...levelAdd]);
  const unionSub = new Set([...manualSub, ...levelSub]);

  for(let a=0;a<=MAX_N;a++){
    for(let b=0;b<=MAX_N;b++){
      const key = k(a,b);

      const addCell = addCells[key];
      if(addCell){
        addCell.classList.toggle("selected", unionAdd.has(key));
        addCell.classList.toggle("levelSelected", levelAdd.has(key));
      }

      const subCell = subCells[key];
      if(subCell){
        subCell.classList.toggle("selected", unionSub.has(key));
        subCell.classList.toggle("levelSelected", levelSub.has(key));
      }
    }
  }
}

function toggleLevel(level, on){
  if(on) activeLevels.add(level);
  else activeLevels.delete(level);
  refreshSelections();
}

function selectAllAddition(){
  for(let a=0;a<=MAX_N;a++){
    for(let b=0;b<=MAX_N;b++){
      manualAdd.add(k(a,b));
    }
  }
  refreshSelections();
}

function clearAddition(){
  manualAdd.clear();
  refreshSelections();
}

function selectAllSubtraction(){
  for(let a=0;a<=MAX_N;a++){
    for(let b=0;b<=a;b++){
      manualSub.add(k(a,b));
    }
  }
  refreshSelections();
}

function clearSubtraction(){
  manualSub.clear();
  refreshSelections();
}

function clearAll(){
  manualAdd.clear();
  manualSub.clear();
  activeLevels.clear();

  ["lvl11","lvl12","lvl13","lvl21","lvl22","lvl23","lvl31","lvl32","lvl33"].forEach(id=>{
    const el = document.getElementById(id);
    if(el) el.checked = false;
  });

  refreshSelections();
}

function getPool(){
  const { levelAdd, levelSub } = getLevelSets();
  const unionAdd = new Set([...manualAdd, ...levelAdd]);
  const unionSub = new Set([...manualSub, ...levelSub]);

  const pool = [];

  if(opChoice === "add" || opChoice === "both"){
    unionAdd.forEach(s=>{
      const p = parseKey(s);
      pool.push({ op:"add", a:p.a, b:p.b });
    });
  }

  if(opChoice === "sub" || opChoice === "both"){
    unionSub.forEach(s=>{
      const p = parseKey(s);
      pool.push({ op:"sub", a:p.a, b:p.b });
    });
  }

  return pool;
}

function pickFrom(pool){
  return pool[Math.floor(Math.random() * pool.length)];
}

function fmtFront(item){
  if(item.op === "add") return item.a + " + " + item.b;
  return item.a + " − " + item.b;
}

function valAnswer(item){
  if(item.op === "add") return item.a + item.b;
  return item.a - item.b;
}

function generate(){
  const pool = getPool();
  if(pool.length === 0){
    alert("Select at least one fact for the chosen operation.");
    return;
  }

  if(mode === "practice") generateWorksheets(pool);
  else generateFlashcards(pool);
}

function generateWorksheets(pool){
  let pagesHtml = "";

  for(let p=0;p<pageCount;p++){
    let cols = "";

    for(let c=0;c<3;c++){
      let col = "";
      for(let r=0;r<10;r++){
        const q = pickFrom(pool);
        col += `<div class="q">${fmtFront(q)}<span class="ans"></span></div>`;
      }
      cols += `<div class="col">${col}</div>`;
    }

    const title =
      opChoice === "add" ? "Addition Facts Practice" :
      opChoice === "sub" ? "Subtraction Facts Practice" :
      "Number Facts Practice";

    pagesHtml += `
      <div class="printPage">
        <div class="centerFrame">
          <div class="worksheet">
            <div class="worksheetTitle">${title}</div>
            <div class="nameDateRow">
              <span class="label">Name</span><span class="line"></span>
              <span class="gap"></span>
              <span class="label">Date</span><span class="line"></span>
            </div>
            <div class="cols">${cols}</div>
          </div>
        </div>
      </div>
    `;
  }

  openPrintWindow(pagesHtml);
}

function generateFlashcards(pool){
  function makeSetOfTen(){
    const ten = [];
    for(let i=0;i<10;i++) ten.push(pickFrom(pool));
    return ten;
  }

  function chunkIntoRows(cards){
    const rows = [];
    for(let r=0;r<5;r++) rows.push([cards[r*2], cards[r*2+1]]);
    return rows;
  }

  let pagesHtml = "";

  for(let p=0;p<pageCount;p++){
    const cards = makeSetOfTen();
    const rows = chunkIntoRows(cards);

    let fronts = "";
    for(const row of rows){
      fronts += `<div class="card">${fmtFront(row[0])}</div>`;
      fronts += `<div class="card">${fmtFront(row[1])}</div>`;
    }

    let backs = "";
    for(const row of rows){
      const leftAns = valAnswer(row[0]);
      const rightAns = valAnswer(row[1]);
      backs += `<div class="card">${rightAns}</div>`;
      backs += `<div class="card">${leftAns}</div>`;
    }

    pagesHtml += `
      <div class="printPage">
        <div class="centerFrame">
          <div class="cardsGrid">${fronts}</div>
        </div>
      </div>
      <div class="printPage">
        <div class="centerFrame">
          <div class="cardsGrid">${backs}</div>
        </div>
      </div>
    `;
  }

  openPrintWindow(pagesHtml);
}

function openPrintWindow(pagesHtml){
  const win = window.open("print.html", "_blank");
  if(!win || !win.document){
    alert("Your browser blocked the new window. Allow popups for this page, then try again.");
    return;
  }

  const printStyles = `
    @page{ margin: 30px; }

    html, body{ height: 100%; }
    body{ font-family: Arial, sans-serif; margin: 0; color:#111; background:#fff; }

    .noPrint{
      position: fixed;
      top: 12px;
      left: 50%;
      transform: translateX(-50%);
      z-index: 9999;
    }

    .printBtn{
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding:8px 12px;
      border:1px solid #777;
      background:#fff;
      cursor:pointer;
      border-radius:10px;
      font-size:14px;
    }

    .printIcon{
      width:18px;
      height:18px;
      display:inline-block;
    }

    .printPage{
      page-break-after: always;
      height: calc(100vh - 60px);
      display:flex;
      align-items:center;
      justify-content:center;
      box-sizing:border-box;
    }

    .centerFrame{
      width:100%;
      display:flex;
      align-items:center;
      justify-content:center;
    }

    .worksheet{
      width: 860px;
      display:flex;
      flex-direction:column;
      align-items:center;
    }

    .worksheetTitle{
      font-weight:700;
      font-size:18px;
      text-align:center;
      margin-bottom: 40px;
    }

    .nameDateRow{
      width: 860px;
      display:flex;
      align-items:flex-end;
      justify-content:center;
      font-size:14px;
      margin-bottom: 40px;
    }

    .nameDateRow .label{
      margin-right: 10px;
      white-space:nowrap;
    }

    .nameDateRow .line{
      display:inline-block;
      width: 240px;
      border-bottom: 2px solid #111;
      height: 16px;
    }

    .nameDateRow .gap{
      display:inline-block;
      width: 40px;
    }

    .cols{
      display:grid;
      grid-template-columns: repeat(3, auto);
      column-gap: 80px;
      justify-content:center;
    }

    .col{
      display:flex;
      flex-direction:column;
    }

    .q{
      font-size:22px;
      line-height:2.7;
      padding:6px 0;
      white-space:nowrap;
    }

    .ans{
      display:inline-block;
      width:70px;
      border-bottom:2px solid #111;
      margin-left:14px;
      vertical-align:baseline;
    }

    .cardsGrid{
      width: 820px;
      display:grid;
      grid-template-columns: repeat(2, 1fr);
      grid-template-rows: repeat(5, auto);
      gap: 14px;
    }

    .card{
      border:2px solid #111;
      border-radius:10px;
      height:150px;
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:52px;
      font-weight:700;
      line-height:1;
    }

    @media print{
      .noPrint{display:none;}
      .printPage{
        height:auto;
        min-height: calc(11in - 60px);
        align-items:center;
        justify-content:center;
      }
    }
  `;

  win.document.open();
  win.document.write(`
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<title></title>
<style>${printStyles}</style>
</head>
<body>
  <div class="noPrint">
    <button class="printBtn" onclick="window.print()">
      <svg class="printIcon" viewBox="0 0 24 24" aria-hidden="true">
        <path d="M6 9V3h12v6H6zm10-2V5H8v2h8zm4 4a3 3 0 0 1 3 3v5h-5v2H6v-2H1v-5a3 3 0 0 1 3-3h16zm-4 10v-5H8v5h8zm2-7a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"></path>
      </svg>
      Print
    </button>
  </div>
  ${pagesHtml}
</body>
</html>`);
  win.document.close();
}

buildAdditionTable();
buildSubtractionTable();
updateHint();
refreshSelections();
</script>
</body>
</html>
